-- Initialize database and create application user
-- Generated by Ansible from template

CREATE DATABASE IF NOT EXISTS {{ docker.mysql.database }};

CREATE USER IF NOT EXISTS '{{ docker.mysql.app_user }}'@'%' IDENTIFIED BY '{{ docker.mysql.app_password }}';
GRANT ALL PRIVILEGES ON {{ docker.mysql.database }}.* TO '{{ docker.mysql.app_user }}'@'%';
FLUSH PRIVILEGES;

-- Create example table for testing
USE {{ docker.mysql.database }};

CREATE TABLE IF NOT EXISTS test_table (
    id INT AUTO_INCREMENT PRIMARY KEY,
    message VARCHAR(255)
);

-- Create example table entries
INSERT INTO test_table (message) VALUES
('{{ competition_name }} example website connected to MySQL database successfully!'),
('Example message 2'),
('Database initialized by Ansible');
